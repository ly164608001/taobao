<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lxhrainy.myjz.admin.houses.dao.IHousesAduitDao">
	<sql id="baseColumn">
		T.id,T.name,T.housespic,T.certificatepic,T.discounttype,T.discountvalue,T.status,T.classid,T.price,T.estatetypeids,T.location,
		T.detailaddress,T.longitude,T.latitude,T.createtime,T.createuser,T.auditor,T.audittime,T.auditmemo,T.apartmentpic,T.villapic,T.modifyuser,
		T.modifytime,T.soldoutuser,T.soldouttime,T.deleted
	</sql>

	<select id="findListByPage" resultType="HousesInfo">
		SELECT 
			<include refid="baseColumn"></include> 
		FROM 
			houses_info T
		<if test="condition!=null">
			<where>
				T.deleted != 1
				<if test="condition.model!=null">
					<if test="condition.model.name!=null and condition.model.name!=''">
						AND T.name LIKE '%${condition.model.name}%'
					</if>
				</if>
			</where>
			ORDER BY T.id DESC
			<include refid="Sql.pager" />
		</if>
	</select>
	
	<select id="getCountByCondition" resultType="int">
		SELECT 
			count(*)
		FROM 
			houses_info T
		<if test="condition!=null">
			<where>
				T.deleted != 1
				<if test="condition.model!=null">
					<if test="condition.model.name!=null and condition.model.name!=''">
						and	T.name LIKE '%${condition.model.name}%'
					</if>
				</if>
			</where>
		</if>
	</select>
	
	<select id="findAllList" resultType="HousesInfo">
		SELECT 
			<include refid="baseColumn"></include>  
		FROM 
			houses_info T
		<where>
			<if test="condition!=null">
				<if test="condition.model!=null">
					<if test="condition.model.name!=null and condition.model.name!=''">
						T.name LIKE '${condition.model.name}%'
					</if>
				</if>
			</if>
		</where>		
	</select>
	
	<!--根据ID获取详情  -->
	<select id="getById" resultType="HousesInfo">
		SELECT 
			<include refid="baseColumn"></include> 	
		FROM 
			houses_info T 
		WHERE 
			id = #{id}
	</select>
	
	<update id="update" parameterType="HousesInfo" >
		UPDATE 
			houses_info
		<set>
			<if test="status != null">
				status = ${status},
			</if>
		</set>
		WHERE 
			id = ${id}
	</update>
	
	<update id="deleteById">
		UPDATE 
			houses_info 
		set 
			deleted=1
		WHERE 
			id = #{id}
	</update>
	
</mapper>