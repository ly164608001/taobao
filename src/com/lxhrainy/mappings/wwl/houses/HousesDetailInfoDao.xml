<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lxhrainy.myjz.admin.houses.dao.IHousesDetailInfoDao">
	<sql id="baseColumn">
		T.id,T.featureids,T.loopposition,T.propertycosts,T.equitylife,T.decoratestateId,T.floorspace,T.builespace,
		T.plotratio,T.greeningrate,T.estateenterprise,T.estateaddress,T.telephone,T.saleaddress,T.businessarea,
		T.housesid,T.modifyuser,T.modifytime,T.deleted,T.description
	</sql>

	<select id="findListByPage" resultType="HousesDetailInfo">
		SELECT 
			<include refid="baseColumn"></include>
			,T.housesid AS "houses.id" 
		FROM 
			houses_detail_info T
		<if test="condition!=null">
			<where>
				T.deleted !=1
			</where>
			ORDER BY T.id DESC
			<include refid="Sql.pager" />
		</if>
	</select>
	
	<select id="getCountByCondition" resultType="int">
		SELECT 
			count(*)
		FROM
			houses_detail_info T
		<if test="condition!=null">
			<where>
				T.deleted !=1
			</where>
		</if>
	</select>
	
	<select id="findAllList" resultType="HousesDetailInfo">
		SELECT 
			<include refid="baseColumn"></include>
			,T.housesid as "houses.id"
		FROM 
			houses_detail_info T
		<where>
			T.deleted !=1
		</where>
	</select>
	

	<!--根据ID获取详情  -->
	<select id="getById" resultType="HousesDetailInfo">
		SELECT 
			<include refid="baseColumn"></include>
			,T.housesid AS "houses.id"
		FROM 
			houses_detail_info T
		WHERE 
			T.id = #{id}	
	</select>
	
<!-- 根据ID删除楼盘信息 -->
	<update id="deleteById">
		UPDATE 
			houses_detail_info 
		SET 
			deleted=1
		WHERE
			id = #{id}
	</update>
	
	<!-- 插入楼盘详细信息 -->
	<insert id="insert" >
		<!-- 配置Mysql主键自动增长 -->
		<selectKey resultType="int" keyProperty="id" order="BEFORE">
			SELECT 
				auto_increment AS id 
			FROM 
				information_schema.tables    
    		WHERE 
    			table_name='houses_detail_info'
		</selectKey>
		INSERT INTO 
			houses_detail_info (
				id,
				featureids,
		       	loopposition,
		        propertycosts, 
		        equitylife,
		        decoratestateId,
		        floorspace,
		        builespace,
		        plotratio,
		        greeningrate,
		        estateenterprise,
		        estateaddress,
		        telephone,
		        saleaddress,
		        businessarea,
		      	housesid,
		       	modifyuser,
		       	modifytime,
		       	deleted,
		       	description
			)
		VALUES (
	    	#{id},
			#{featureids},
	       	#{loopposition},
	        #{propertycosts}, 
	        #{equitylife},
	        #{decoratestateId},
	        #{floorspace},
	        #{builespace},
	        #{plotratio},
	        #{greeningrate},
	        #{estateenterprise},
	        #{estateaddress},
	        #{telephone},
	        #{saleaddress},
	        #{businessarea},
	      	#{houses.id},
	       	#{modifyuser},
	       	#{modifytime},
	       	#{deleted},
	       	#{description}
	      )
	</insert>
	<!-- 更新楼盘基本信息 -->
	<update id="update">
		UPDATE 
			houses_detail_info 
		<set>
		<if test="featureids !=null and featureids !=''">
			featureids = #{featureids},
		</if>
		<if test="loopposition !=null and loopposition !=''">
			loopposition = #{loopposition},
		</if>
		<if test="propertycosts !=null and propertycosts !='' ">
			propertycosts = #{propertycosts},
		</if>
		<if test="equitylife !=null and equitylife !=''" >
			equitylife = #{equitylife},
		</if>
		<if test="decoratestateId !=null and decoratestateId !=''">
			decoratestateId = #{decoratestateId},
		</if>
		<if test="floorspace !=null and floorspace !=''" >
			floorspace = #{floorspace},
		</if>
		<if test="builespace !=null and builespace !='' ">
			builespace = #{builespace},
		</if>
		<if test="plotratio !=null and plotratio !=''">
			plotratio = #{plotratio},
		</if>
		<if test="greeningrate !=null and greeningrate !=''">
			greeningrate = #{greeningrate},
		</if>
		<if test="estateenterprise !=null and estateenterprise !=''">
			estateenterprise = #{estateenterprise},
		</if>
		<if test="estateaddress !=null and estateaddress !=''">
			estateaddress = #{estateaddress},
		</if>
		<if test="telephone !=null and telephone !=''">
			telephone = #{telephone},
		</if>
		<if test="saleaddress !=null and saleaddress !=''">
			saleaddress = #{saleaddress},
		</if>
		<if test="businessarea !=null and businessarea !=''">
			businessarea = #{businessarea},
		</if>
		<if test="houses != null and houses.id !=null and houses.id !=''">
			housesid = #{houses.id},
		</if>
		<if test="modifyuser !=null and modifyuser !=''">
			modifyuser = #{modifyuser},
		</if>
		<if test="modifytime !=null and modifytime !=''">
			modifytime = #{modifytime},
		</if>
		<if test="deleted !=null and deleted !=''">
			deleted = #{deleted},
		</if>
		<if test="description !=null and description !=''">
			description = #{description},
		</if>
	</set>
		WHERE 
			id = #{id}
	</update>
	
	<!--根据楼盘ID获取楼盘详细信息  -->
	<select id="getDetailInfoByHousesId" resultType="HousesDetailInfo">
		SELECT 
			<include refid="baseColumn"></include>
		FROM 
			houses_detail_info T
		WHERE 
			housesid = #{housesid}
	</select>
</mapper>