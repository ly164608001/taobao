<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lxhrainy.myjz.admin.activity.dao.IActivityThematicUserDao">
    
    <resultMap id="ActivityThematicUser" type="com.lxhrainy.myjz.admin.activity.model.ActivityThematicUser">
		<id property="id" column="id" />
		<result column="activityid" property="activityid"/>
	    <result column="userid" property="userid"/>
	    <result column="applytime" property="applytime"/>
	    <result column="status" property="status"/>
	    <result column="username" property="username"/>
	    <result column="contactphone" property="contactphone"/>
	    <result column="deleted" property="deleted"/>
	</resultMap>
	
	<sql id="activityThematicUserColumns">
		T.id AS "id",
		T.activityid AS "activityid",
		T. userid AS "userid",
		T.applytime AS "applytime",
		T.status AS "status",
		T.username AS "username",
		T.contactphone AS "contactphone",
		T.deleted AS "deleted"
	</sql>
	
    
	<sql id="activityThematicUserJoins">
	left JOIN activity_thematic a ON a.id = T.activityid
	</sql>
    
	<select id="getById" resultType="ActivityThematicUser">
		SELECT 
			<include refid="activityThematicUserColumns"/>
		FROM activity_thematic_user T
		<include refid="activityThematicUserJoins"/>
		WHERE T.id = #{id}
	</select>
	
	<select id="findListByPage" resultMap="ActivityThematicUser">
		SELECT 
			<include refid="activityThematicUserColumns"/>
		FROM activity_thematic_user T
		
		<if test="condition!=null">
			<where>
				T.deleted=0
				<if test="condition.model!=null">
					<if test="condition.model.activityid!=null">
						AND T.activityid= '${condition.model.activityid}'
					</if>
					<if test="condition.model.status!=null ">
						AND T.status= '${condition.model.status}'
					</if>
					<if test="condition.model.username!=null and condition.model.username!=''">
						 AND T.username LIKE '%${condition.model.username}%'
					</if>
					<if test="condition.model.contactphone!=null and condition.model.contactphone!=''">
						 AND T.contactphone LIKE '%${condition.model.contactphone}%'
					</if>
					
				</if>
			</where>
			order by T.ID DESC
			<include refid="Sql.pager" />
		</if>
	</select>
	<select id="getCountByCondition" resultType="int">
		SELECT 
			count(*)
		FROM activity_thematic_user T
		<include refid="activityThematicUserJoins"/>
		<if test="condition!=null">
			<where>
				T.deleted=0
				<if test="condition.model!=null">
					<if test="condition.model.activityid!=null and condition.model.activityid!=''">
						AND T.activityid= '${condition.model.activityid}'
					</if>
					<if test="condition.model.status!=null and condition.model.status!=''">
						AND T.status= '${condition.model.status}'
					</if>
					<if test="condition.model.username!=null and condition.model.username!=''">
						 AND T.username LIKE '%${condition.model.username}%'
					</if>
					<if test="condition.model.contactphone!=null and condition.model.contactphone!=''">
						 AND T.contactphone LIKE '%${condition.model.contactphone}%'
					</if>
				</if>
			</where>
		</if>
	</select>
	
	<select id="findAllList" resultType="ActivityThematicUser">
		SELECT 
			<include refid="activityThematicUserColumns"/>
		FROM activity_thematic_user T
		<include refid="activityThematicUserJoins"/>
		<where>
			T.deleted=0
			<if test="condition!=null">
				<if test="condition.model!=null">
					<if test="condition.model.activityid!=null and condition.model.activityid!=''">
						AND T.activityid= '${condition.model.activityid}'
					</if>
					<if test="condition.model.status!=null and condition.model.status!=''">
						AND	T.status= '${condition.model.status}'
					</if>
					<if test="condition.model.username!=null and condition.model.username!=''">
						AND T.username LIKE '%${condition.model.username}%'
					</if>
					<if test="condition.model.contactphone!=null and condition.model.contactphone!=''">
						AND T.contactphone LIKE '%${condition.model.contactphone}%'
					</if>
				</if>
			</if>
		</where>		
	</select>
	
	<insert id="insert">
	INSERT INTO activity_thematic_user (
		id,
		activityid,
		userid,
		applytime,
		status,
		username,
		contactphone,
		deleted
		)values (
		#{id},
		#{activityid},
		#{userid},
		#{applytime},
		#{status},
		#{username},
		#{contactphone},
		#{deleted}
		)
		<!-- 配置Mysql主键自动增长 -->
		<selectKey resultType="int" keyProperty="id">
			select
			LAST_INSERT_ID() as value  
		</selectKey>
	</insert>
		
	 <update id="update" >
    update activity_thematic_user
    <set >
      <if test="activityid != null" >
        activityid = #{activityid},
      </if>
      <if test="userid != null" >
        userid = #{userid},
      </if>
      <if test="applytime != null" >
        applytime = #{applytime},
      </if>
      <if test="status != null" >
        status = #{status},
      </if>
      <if test="username != null" >
        username = #{username},
      </if>
      <if test="contactphone != null" >
        contactphone = #{contactphone},
      </if>
      <if test="deleted != null" >
        deleted = #{deleted},
      </if>
    </set>
    where id = #{id}
  </update>
	
	<update id="deleteById">
		update activity_thematic_user set 
			deleted=1
		WHERE id = #{id}
	</update>
	
</mapper>