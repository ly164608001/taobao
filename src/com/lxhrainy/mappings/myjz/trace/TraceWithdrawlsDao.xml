<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lxhrainy.myjz.admin.trace.dao.ITraceWithdrawlsDao">
    
	<sql id="traceWithdrawlsColumns">
		T.id AS "id",
		T.money AS "money",
		T.commission AS "commission",
		T.arrivalmoney AS "arrivalmoney",
		T.withdrawalsaccount AS "account.id",
		T.status AS "status",
		T.createtime AS "createtime",
		T.finishtime AS "finishtime",
		T.withdrawalno AS "withdrawalno",
		T.userid AS "user.id",
		T.type AS "type",
		
		A.accountno AS "account.accountno"
	</sql>
	
	<sql id="traceWithdrawlsJoins">
		LEFT JOIN user_account A ON A.id = T.withdrawalsaccount
	</sql>
	
	<sql id="where">
		<if test="condition!=null">
			<where>
				<if test="condition.model!=null">
					<if test="condition.model.withdrawalno!=null and condition.model.withdrawalno!=''">
						AND T.withdrawalno like CONCAT('%',#{condition.model.withdrawalno},'%')
					</if>
				</if>
			</where>
		</if>
	</sql>
    
	<select id="getById" resultType="TraceWithdrawls">
		SELECT 
			<include refid="traceWithdrawlsColumns"/>
		FROM trace_withdrawls T
		<include refid="traceWithdrawlsJoins"/>
		WHERE T.id = #{id}
	</select>
	
	<select id="findListByPage" resultType="TraceWithdrawls">
		SELECT 
			<include refid="traceWithdrawlsColumns"/>
		FROM trace_withdrawls T
		<include refid="traceWithdrawlsJoins"/>
		<include refid="where"/>
		order by T.ID
			<include refid="Sql.pager" />
	</select>
	
	<select id="findAllList" resultType="TraceWithdrawls">
		SELECT 
			<include refid="traceWithdrawlsColumns"/>
		FROM trace_withdrawls T
		<include refid="traceWithdrawlsJoins"/>
		<include refid="where"/>
	</select>
	
	<select id="getCountByCondition" resultType="int">
		SELECT 
			COUNT(1)
		FROM trace_withdrawls T
		<include refid="traceWithdrawlsJoins"/>
		<include refid="where"/>
	</select>
	
	<insert id="insert">
		INSERT INTO trace_withdrawls(
			id,
			money,
			commission,
			arrivalmoney,
			withdrawalsaccount,
			status,
			createtime,
			finishtime,
			withdrawalno,
			userid,
			type
		) VALUES (
			#{id},
			#{money},
			#{commission},
			#{arrivalmoney},
			#{account.id},
			#{status},
			#{createtime},
			#{finishtime},
			#{withdrawalno},
			#{user.id},
			#{type}
		)
	</insert>
	
	<update id="update">
		UPDATE trace_withdrawls SET 
			type = #{type},
			money = #{money},
			commission = #{commission},
			arrivalmoney = #{arrivalmoney},
			withdrawalsaccount = #{account.id},
			status = #{status},
			createtime = #{createtime},
			finishtime = #{finishtime},
			withdrawalno = #{withdrawalno},
			userid = #{user.id}
		WHERE id = #{id}
	</update>
	
	<update id="delete">
		DELETE FROM trace_withdrawls
		WHERE id = #{id}
	</update>
	
</mapper>